- name: Download cmake source code and checksum
  get_url:
    url: https://github.com/Kitware/CMake/releases/download/v3.20.0/cmake-3.20.0.tar.gz
    dest: /usr/local/src/cmake-3.20.0.tar.gz
    checksum: md5:9079201b76ca8d5b8b5337443369ae59

- name: Unarchive tar the cmake
  unarchive:
    src: /usr/local/src/cmake-3.20.0.tar.gz
    dest: /usr/local/src
    remote_src: yes

- name: build cmake
  shell: ./bootstrap && make && make install
  args:
    executable: /bin/bash
    chdir: /usr/local/src/cmake-3.20.0

- name: Symbolic CLI tool
  file:
    src: /usr/local/bin/cmake
    dest: /usr/bin/cmake
    state: link
    force: true

- name: Git clone bcg729
  git:
    repo: https://github.com/hnimminh/mod_bcg729.git
    dest: /usr/local/src/mod_bcg729
    recursive: no
    clone: yes
    force: true

- name: build bcg729
  shell: make && make install
  args:
    executable: /bin/bash
    chdir: /usr/local/src/mod_bcg729
